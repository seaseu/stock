<<<<<<< HEAD
# stock
=======
# TQQQ 1分钟 边界交易策略

## 策略概述

基于MA14均线的边界交易策略，适合TQQQ 1分钟K线数据。

## 核心参数

| 参数 | 值 | 说明 |
|------|-----|------|
| INITIAL_CAPITAL | 20000 | 初始资金 |
| BUILD_LEVELS | 5 | 建仓档位数量 |
| PROFIT_LEVELS | 5 | 止盈档位数量 |
| MAX_POSITION_RATIO | 0.20 | 单档位最大仓位比例 |
| BUY_DROP | 0.01 | 首档建仓价 = MA14 × (1 - 0.01) |
| SELL_RISE | 0.001 | 首档止盈价 = MA14 × (1 + 0.001) |
| LEVEL_SPREAD | 0.001 | 档位间距 = 0.1% |

## 交易规则

### 建仓条件
- 当前无持仓
- 当前小时 <= 2 (仅在交易时段开始后前3小时内建仓)
- 最低价触及建仓档位

### 止盈规则
- 最高价触及任一止盈档位时卖出
- 逐档卖出：Level 1 → Level 2 → ... → Level 5

### 强制平仓
- 小时 >= 4 且小时 < 22 时强制平仓（避免隔夜持仓）
- 仅在盈利时平仓（亏损不卖）

## 回测结果

```
初始资金: $20,000.00
最终资金: $20,430.00
总收益率: 2.15%
总交易次数: 18
```

## 交易记录摘要

| 日期 | 建仓时间 | 建仓价 | 平仓时间 | 平仓价 | 收益率 |
|------|----------|--------|----------|--------|--------|
| 2025-12-03 | 00:14 | 54.87 | 03:52 | 55.50 | +1.1% |
| 2025-12-13 | 00:00 | 52.88 | 02:13 | 53.79 | +1.7% |
| 2025-12-19 | 01:09 | 51.64 | 02:25 | 52.24 | +1.2% |
| 2026-01-03 | 00:00 | 52.17 | 04:00 | 52.44 | +0.5% |
| 2026-01-22 | 00:40 | 51.90 | 03:30 | 52.49 | +1.1% |
| 2026-02-04 | 01:13 | 52.26 | 04:39 | 52.38 | +0.2% |
| 2026-02-05 | 00:41 | 49.80 | 03:49 | 50.35 | +1.1% |
| 2026-02-18 | 00:00 | 47.20 | 00:14 | 48.37 | +2.5% |
| 2026-02-21 | 01:16 | 49.30 | 02:34 | 49.92 | +1.3% |

## 策略特点

1. **日内交易**: 仅在交易时段早期建仓，傍晚前平仓，不过夜
2. **趋势追踪**: 在价格回调至MA14下方时建仓，反弹时止盈
3. **风险控制**: 
   - 单档位最大仓位20%
   - 强制平仓机制避免隔夜风险
   - 只在价格触及建仓档位时才买入
   - 强制平仓时只允许盈利卖出

## 运行方式

```bash
cd /Users/jihai/GitHub/stock
source .venv312/bin/activate
python trading_strategy.py
```

## 数据文件

- 1分钟K线数据: `data/分钟级数据/1分钟数据/TQQQ历史数据.csv`
- 回测结果: `backtest_results.csv`
